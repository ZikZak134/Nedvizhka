---
description: MEMORY
---

# üìö PROJECT KNOWLEDGE BASE: EstateAnalytics (Sochi Elite)

> **–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:** ‚úÖ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π VPS (Timeweb Cloud). S3 –±–∞–∫–µ—Ç —É–¥–∞–ª–µ–Ω, –∫–æ–¥ –ø–µ—Ä–µ–ø–∏—Å–∞–Ω –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ.
> **–ú–æ–∂–Ω–æ –ª–∏ –ª—É—á—à–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Zod –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ API –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ.
> **–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ –ø–æ –ø–ª–∞–Ω—É:** –î–µ–ø–ª–æ–π –Ω–∞ "Brainy Halimede" (Timeweb).

---

## üéØ –ú–∏—Å—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞

**EstateAnalytics** ‚Äî –ø—Ä–µ–º–∏–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —Ä—ã–Ω–∫–∞ —ç–ª–∏—Ç–Ω–æ–π –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –°–æ—á–∏.
–¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è: –∏–Ω–≤–µ—Å—Ç–æ—Ä—ã, —Å–µ–º—å–∏, –æ–¥–∏–Ω–æ—á–∫–∏, –∏—â—É—â–∏–µ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å –∫–ª–∞—Å—Å–∞ ¬´–ª—é–∫—Å¬ª.

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### Backend (FastAPI)

| –§—É–Ω–∫—Ü–∏—è | –§–∞–π–ª | –°—Ç–∞—Ç—É—Å |
| --------- | ------ | -------- |
| CRUD –æ–±—ä–µ–∫—Ç–æ–≤ | `api/v1/properties.py` | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| API –∂–∏–ª—ã—Ö –∫–æ–º–ø–ª–µ–∫—Å–æ–≤ | `api/v1/complexes.py` | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| GeoJSON –¥–ª—è –∫–∞—Ä—Ç—ã | `api/v1/heatmap.py` | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| –ü–∞—Ä—Å–µ—Ä—ã (Avito/CIAN) | `parser_service.py` | ‚úÖ –†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |
| –ê–≤—Ç–æ-–ì–µ–æ–∫–æ–¥–∏–Ω–≥ | `geocoding_service.py` | ‚úÖ 2GIS + Fallback |
| –ü—Ä–∏–µ–º –¥–∞–Ω–Ω—ã—Ö (Batch) | `api/v1/parse.py` | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| **–§–∞–π–ª—ã (Local)** | `api/v1/upload.py` | ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–π –¥–∏—Å–∫ |

### Frontend (Next.js)

| –§—É–Ω–∫—Ü–∏—è | –§–∞–π–ª | –°—Ç–∞—Ç—É—Å |
| --------- | ------ | -------- |
| **–ì–ª–∞–≤–Ω–∞—è –∫–∞—Ä—Ç–∞** | `PremiumMap.tsx` | ‚úÖ 2GIS / Native |
| –ì–µ–æ-–ø–∏–∫–µ—Ä (Admin) | `LocationPicker.tsx` | ‚úÖ 2GIS + Sync |
| –ö–∞—Ä—Ç–æ—á–∫–∞ –æ–±—ä–µ–∫—Ç–∞ | `PropertyCard.tsx` | ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω |
| –®–∞–ø–∫–∞/–ú–µ–Ω—é | `Header.tsx`, `HamburgerMenu.tsx` | ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ |
| –§–∏–ª—å—Ç—Ä—ã | `PropertyFilters.tsx` | ‚úÖ –ë–∞–∑–æ–≤—ã–µ |
| –ü–∞–Ω–µ–ª—å —Ä–∞–π–æ–Ω–∞ | `DistrictDetails.tsx` | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| –ì—Ä–∞—Ñ–∏–∫ —Ü–µ–Ω | `PriceChart.tsx` | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |

### –°—Ç—Ä–∞–Ω–∏—Ü—ã

| URL | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
| ----- | -------- | ------------ |
| `/` | ‚úÖ | PremiumMap (Fullscreen) |
| `/map` | ‚úÖ | PremiumMap |
| `/analytics` | ‚úÖ | –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ä—ã–Ω–∫–∞ |
| `/properties` | ‚úÖ | –ö–∞—Ç–∞–ª–æ–≥ |
| `/properties/[id]` | ‚úÖ | –î–µ—Ç–∞–ª–∏ –æ–±—ä–µ–∫—Ç–∞ |
| `/admin` | ‚úÖ | –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å (CRUD) |

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (Target)

- **–°–µ—Ä–≤–µ—Ä**: VPS (Timeweb Cloud).
- **OS**: Ubuntu 22.04 LTS.
- **–°—Ç–µ–∫**: Docker Compose (Nginx + Next.js + FastAPI + PostGIS).
- **–•—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤**: –õ–æ–∫–∞–ª—å–Ω—ã–π –¥–∏—Å–∫ (`/app/uploads`).

### –ö–∞—Ä—Ç—ã

- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 2GIS ‚Äî –Ω–∞—Ç–∏–≤–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ –∏ –Ω—É–º–µ—Ä–∞—Ü–∏–∏ –¥–æ–º–æ–≤.
- **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞**: OSM/Satellite (–≤—ã–±–æ—Ä –≤ UI).
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: `DG.map` API —á–µ—Ä–µ–∑ CDN –ª–æ–∞–¥–µ—Ä.

### –î–∞–Ω–Ω—ã–µ

- **–ò—Å—Ç–æ—á–Ω–∏–∫–∏**: Avito, CIAN (—Ä–µ–∞–ª—å–Ω—ã–µ –ø–∞—Ä—Å–µ—Ä—ã –≤ `app/parsers`).
- **–ì–µ–æ–∫–æ–¥–∏–Ω–≥**: –ï—Å–ª–∏ –ø–∞—Ä—Å–µ—Ä –Ω–µ –Ω–∞—à–µ–ª –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –∏—Ö —É 2GIS API –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º.
- **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í—Å–µ —Ü–µ–Ω—ã –∏ –ø–ª–æ—â–∞–¥–∏ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É—é—Ç—Å—è —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏ (e.g. `401 579`).

---

## üìã –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π (Changelog)

### 2026-01-25 (Infrastructure Migration Strategy Shift)

- üîÑ **Storage**: –û—Ç–∫–∞–∑ –æ—Ç Yandex S3 –≤ –ø–æ–ª—å–∑—É –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –¥–∏—Å–∫–∞ VPS.
    - –ü–µ—Ä–µ–ø–∏—Å–∞–Ω `upload.py` (Local FS).
    - –£–¥–∞–ª–µ–Ω S3 –±–∞–∫–µ—Ç.
- üîÑ **Hosting**: –í—ã–±—Ä–∞–Ω Timeweb Cloud (–≤–º–µ—Å—Ç–æ Yandex Compute).
    - –ë—é–¥–∂–µ—Ç: ~1000 —Ä—É–±/–º–µ—Å.
    - 4 –ì–ë RAM / 50 –ì–ë NVMe.

### 2026-01-24 (Robustness Patch & Deployment Fix)

- ‚úÖ **Stability**: –í–Ω–µ–¥—Ä–µ–Ω–∞ —É—Ç–∏–ª–∏—Ç–∞ `safeArray.ts`.
- ‚úÖ **TS Type Fix**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ `unknown` —Ç–∏–ø–æ–≤ –≤ `PremiumMap.tsx`.

### 2026-01-23 (Real Data Integration - Stage 7)

- ‚úÖ **Parsers**: –ü–æ–¥–∫–ª—é—á–µ–Ω—ã —Ä–µ–∞–ª—å–Ω—ã–µ `AvitoParser` –∏ `CianParser`.
- ‚úÖ **Auto-Geocoding**: –ë—ç–∫–µ–Ω–¥ —Å–∞–º –Ω–∞—Ö–æ–¥–∏—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã.

---

## üó∫Ô∏è Roadmap

### –ë–ª–∏–∂–∞–π—à–∏–µ –∑–∞–¥–∞—á–∏

1. [ ] –î–µ–ø–ª–æ–π –Ω–∞ Timeweb (Docker).
2. [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL (Certbot).
3. [ ] –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (Restore Dump).

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ

- [ ] –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –∏–Ω–≤–µ—Å—Ç–æ—Ä–∞
- [ ] Email/Telegram –ø–æ–¥–ø–∏—Å–∫–∏
- [ ] PDF-–æ—Ç—á–µ—Ç—ã

---

## ü§ñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è AI

> **–í–ê–ñ–ù–û**: –ü–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –ª—é–±–æ–π –∑–∞–¥–∞—á–∏:
>
> 1. –ü—Ä–æ—á–∏—Ç–∞–π —ç—Ç–æ—Ç —Ñ–∞–π–ª (`MEMORY.md`)
> 2. –ü—Ä–æ–≤–µ—Ä—å `ARCHITECTURE.md`
> 3. –û–±–Ω–æ–≤–∏ —ç—Ç–æ—Ç —Ñ–∞–π–ª –ø–æ—Å–ª–µ —Ä–∞–±–æ—Ç—ã
> 4. –°–æ–±–ª—é–¥–∞–π –ø—Ä–∞–≤–∏–ª–æ "–†—É—Å—Å–∫–∏–π —è–∑—ã–∫ –≤–µ–∑–¥–µ"
> 5. **–§–∞–π–ª—ã**: –•—Ä–∞–Ω–∏ –ª–æ–∫–∞–ª—å–Ω–æ –≤ `./uploads` (–≤ Docker volume).

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2026-01-25
